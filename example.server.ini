[uwsgi]
# Application settings
module = api.main:app
callable = app

# Server settings
http = 0.0.0.0:8000
workers = 4
threads = 2

# Process management
master = true
vacuum = true
die-on-term = true
lazy-apps = true

# Performance settings
enable-threads = true
thunder-lock = true
max-requests = 1000
max-requests-delta = 100

# Logging
logto = /var/log/uwsgi/classifier_extractor.log
log-date = true
log-format = %(addr) - %(user) [%(ltime)] "%(method) %(uri) %(proto)" %(status) %(size) "%(referer)" "%(uagent)"

# Static files (if needed)
static-map = /static=/home/telendry/code/ai/classifier_and_extractor/public

# Environment variables
env = POSTGRES_USER=user
env = POSTGRES_PASSWORD=password
env = POSTGRES_HOST=localhost
env = POSTGRES_PORT=5432
env = POSTGRES_DB=database
env = ALLOWED_ORIGINS=*
env = HOST=0.0.0.0
env = PORT=8000
env = DEBUG=false

# Security
uid = www-data
gid = www-data
chmod-socket = 666

# Memory and resource limits
limit-as = 1024
reload-on-rss = 512