<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Document management interface</title>
    <link rel="stylesheet" href="/static/styles.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.1/dist/chart.umd.min.js"></script>
    <script type="importmap">
    {
        "imports": {
            "lit": "/static/node_modules/lit/index.js",
            "lit/": "/static/node_modules/lit/",
            "@lit/reactive-element": "/static/node_modules/@lit/reactive-element/reactive-element.js",
            "@lit/reactive-element/": "/static/node_modules/@lit/reactive-element/",
            "lit-html": "/static/node_modules/lit-html/lit-html.js",
            "lit-html/": "/static/node_modules/lit-html/",
            "lit-element": "/static/node_modules/lit-element/index.js",
            "lit-element/": "/static/node_modules/lit-element/",
            "@types/trusted-types": "/static/node_modules/@types/trusted-types/index.d.ts"
        }
    }
    </script>
</head>
<body>
<div class="app-container">
    <files-list jsum='files_list' class="files-widget-container"></files-list>
    <div class="sections">
        <navigation-menu jsum class="navigation-menu" data-target="#main-views">
            <button data-view="about">Introduction</button>
            <button data-view="classifiers">Classifiers</button>
            <button data-view="extractors">Extractors</button>
            <button data-view="models">Model Manager</button>
            <button data-view="reporting">Usage Reporting</button>
            <button data-view="api_setup">Service API settings</button>
        </navigation-menu>
        <navigation-views class="navigation-views" id="main-views">
            <div data-name="about" class="navigation-view">
                {% include 'sections/about.j2' %}
            </div>
            <div data-name="classifiers" class="navigation-view">
                {% include 'sections/classifiers.j2' %}
            </div>
            <div data-name="extractors" class="navigation-view">
                {% include 'sections/extractors.j2' %}
            </div>
            <div data-name="models" class="navigation-view">
                {% include 'sections/models.j2' %}
            </div>
            <div data-name="reporting" class="navigation-view">
                {% include 'sections/reporting.j2' %}
            </div>
            <div data-name="api_setup" class="navigation-view">
                {% include 'sections/api_setup.j2' %}
            </div>
        </navigation-views>
    </div>
</div>
<user-menu jsum></user-menu>
<login-modal jsum></login-modal>
<account-modal jsum></account-modal>
</body>
<script type="module">
    // Utility includes
    import {API_REST} from './static/js/lib/API.js';
    import {multicall} from './static/js/lib/jsum.js';

    // Navigation components
    import {NavigationMenu} from './static/js/lib/menu.js';
    import {NavigationView} from './static/js/lib/navigation.js';

    // Components
    import {LoginModal} from './static/js/components/login_modal.js';
    import {UserMenu} from './static/js/components/user_menu.js';
    import {AccountModal} from './static/js/components/account_modal.js';
    import {FilesList} from './static/js/components/files_list.js';
    import {ClassifierEditor} from './static/js/components/classifier_editor.js';
    import {ExtractorEditor} from './static/js/components/extractor_editor.js';
    import {ModelManager} from './static/js/components/model_manager.js';
    import {UsageReportingDashboard} from './static/js/components/usage_reporting_dashboard.js';
    import './static/js/components/api_config.js';
    import './static/js/components/api_reference.js';

    window.addEventListener('load', () => {
        /**
         * Initialize server API and broadcast the connection
         * to all JSUM components.
         */
        const api = new API_REST(window.location.origin, (error) => {
            console.log("Server API error: " + error);
            multicall(
                {
                    'target': 'service_error',
                    'query': '[jsum]',
                    'params': [error]
                }
            );
        });
        multicall(
            {
                'target': 'server_interface',
                'query': '[jsum]',
                'params': [api]
            }
        );
    });
</script>
</html>