<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Document management interface</title>
    <link rel="stylesheet" href="/static/styles.css">
    <script type="importmap">
    {
        "imports": {
            "lit": "/static/node_modules/lit/index.js",
            "lit/": "/static/node_modules/lit/",
            "@lit/reactive-element": "/static/node_modules/@lit/reactive-element/reactive-element.js",
            "@lit/reactive-element/": "/static/node_modules/@lit/reactive-element/",
            "lit-html": "/static/node_modules/lit-html/lit-html.js",
            "lit-html/": "/static/node_modules/lit-html/",
            "lit-element": "/static/node_modules/lit-element/index.js",
            "lit-element/": "/static/node_modules/lit-element/",
            "@types/trusted-types": "/static/node_modules/@types/trusted-types/index.d.ts"
        }
    }
    </script>
</head>
<body>
<div class="app-container">
    <files-list jsum></files-list>
    <div class="sections">
        <navigation-menu jsum class="navigation-menu" data-target="#main-views">
            <button data-view="about">About</button>
            <button data-view="classifiers">Classifiers</button>
            <button data-view="extractors">Extractors</button>
        </navigation-menu>
    </div>
    <navigation-views class="navigation-views" id="main-views">
        <div data-name="about" class="navigation-view">
            {% include 'sections/about.j2' %}
        </div>
        <div data-name="classifiers" class="navigation-view">
            {% include 'sections/classifiers.j2' %}
        </div>
        <div data-name="extractors" class="navigation-view">
            {% include 'sections/extractors.j2' %}
        </div>
    </navigation-views>
</div>
<login-modal jsum></login-modal>
</body>
<script type="module">
    // Utility includes
    import {API_REST} from './static/js/lib/API.js';
    import {multicall} from './static/js/lib/jsum.js';

    // Navigation components
    import {NavigationMenu} from './static/js/lib/menu.js';
    import {NavigationView} from './static/js/lib/navigation.js';

    // Components
    import {LoginModal} from './static/js/components/login_modal.js';
    import {FilesList} from './static/js/components/files_list.js';

    window.addEventListener('load', () => {
        /**
         * Initialize server API and broadcast the connection
         * to all JSUM components.
         */
        const api = new API_REST(window.location.origin, (error) => {
            console.log("Server API error: " + error);
            multicall(
                {
                    'target': 'service_error',
                    'query': '[jsum]',
                    'params': [error]
                }
            );
        });
        multicall(
            {
                'target': 'server_interface',
                'query': '[jsum]',
                'params': [api]
            }
        );
    });
</script>
</html>